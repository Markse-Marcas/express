import{u as F,c as a,a as G,i as H,b as l,t as J}from"./index-57880aa4.js";import{s as d}from"./supabaseClient-fe222147.js";import{v as K}from"./v4-a960c1f4.js";const M=J('<div aria-live="polite"><form class=""><div><label for="number">Número</label><input id="number" type="text"></div><div><label for="description">Descrição</label><input id="description" type="text"></div><div><label for="complement">Complemento</label><input id="complement" type="text"></div><div><label for="activityClass">Classe de atividade</label><input id="activityClass" type="text"></div><div><select name="phases" id="phases" required><option selected disabled>Escolha uma opção: </option></select></div><div><button type="submit" class="">'),W=()=>{const u=F(),[f,v]=a(""),[b,h]=a(null),[g,_]=a(null),[p,y]=a(""),[$,o]=a(!1),[C,x]=a(null),[A,I]=a("");G(()=>{N()});const N=async()=>{try{o(!0);let{data:e,error:t}=await d.from("process").select(`
                    id,
                    number,
                    activity_class,
                    description,
                    complement,
                    brand_id
                `).eq("id",u.id).single();if(t)throw t;e&&(y(e.id),x(e.number),v(e.activity_class),_(e.description),h(e.complement))}catch(e){e instanceof Error&&alert(e.message)}finally{o(!1),z()}},q=async(e,t)=>{try{const{error:i}=await d.from("phase_process").insert({phase_id:e,process_id:t});if(i)throw i}catch(i){i instanceof Error&&alert(i.message)}},z=async()=>{try{const{data:e,error:t}=await d.from("phase").select("id, description");if(t)throw t;const i=document.getElementById("phases");for(let{id:r,description:c}of e){let n=document.createElement("option");n.setAttribute("value",r);let m=document.createTextNode(c);n.appendChild(m),i?.appendChild(n)}}catch(e){e instanceof Error&&alert(e.message)}},B=async e=>{e.preventDefault();try{o(!0),p()||y(K());const t={id:p(),activity_class:f(),number:C(),description:g(),complement:b(),brand_id:u.brandId};let{data:i,error:r}=await d.from("process").upsert(t).select();if(i&&q(A(),p()),r)throw r}catch(t){t instanceof Error&&alert(t.message)}finally{o(!1)}};return(()=>{const e=M(),t=e.firstChild,i=t.firstChild,r=i.firstChild,c=r.nextSibling,n=i.nextSibling,m=n.firstChild,E=m.nextSibling,S=n.nextSibling,O=S.firstChild,w=O.nextSibling,P=S.nextSibling,R=P.firstChild,L=R.nextSibling,T=P.nextSibling,j=T.firstChild,k=T.nextSibling,D=k.firstChild;return t.addEventListener("submit",B),c.addEventListener("change",s=>x(Number.parseInt(s.currentTarget.value))),E.addEventListener("change",s=>_(s.currentTarget.value)),w.addEventListener("change",s=>h(s.currentTarget.value)),L.addEventListener("change",s=>v(s.currentTarget.value)),j.addEventListener("change",s=>{I(s.target.value)}),H(D,()=>$()?"Carregando...":"Atualizar processo"),l(()=>D.disabled=$()),l(()=>c.value=C()||""),l(()=>E.value=g()||""),l(()=>w.value=b()||""),l(()=>L.value=f()||""),e})()};export{W as default};
